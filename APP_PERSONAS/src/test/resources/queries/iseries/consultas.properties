SQL.COMFFLGWWW.tramaDatos_0220_0230=SELECT DATOS FROM COMLIBRAMD.COMFFLGWWW WHERE SUBSTR(CLVTRN, 9, 21) = :TRACE
SQL.SCIFFMRCMV.MovimientoDeposito=SELECT * FROM SCILIBRAMD.SCIFFMRCMV WHERE MOVCODCTA = :CUENTA AND MOVTIPCTA = :TIPOCUENTA AND MOVFECEFC = :FECHA AND MOVVLREFC = :MONTO AND MOVNATTRN = :NATURALEZA AND MOVHRARCB > :HORA ORDER BY 2 DESC FETCH FIRST 1 ROW ONLY
SQL.PCCFFMOVTF.consultarIdSistemaDebCre=SELECT MVIDENTI FROM PCCLIBRAMD.PCCFFMOVTF where MVDIACLA = :DIA AND MVCTADB = :CUENTADEBITO AND MVTIPCDB = :TIPOCUENTADEBITO AND MVCTACR = :CUENTACREDITO AND MVTIPCCR = :TIPOCUENTACREDITO ORDER BY MVHOR DESC, MVMIN DESC, MVSEG DESC LIMIT 1
SQL.PCCFFLOGTF.consultarRegistroLogTf=SELECT * FROM PCCLIBRAMD.PCCFFLOGTF WHERE LGDATOS LIKE :IDSISTEMA
SQL.PCCFFMOVTFLOGTF.consultarRegistroDeb=SELECT PCCLIBRAMD.PCCFFLOGTF.* FROM PCCLIBRAMD.PCCFFLOGTF WHERE substr(LGDATOS, 106, 10) IN (SELECT MVIDENTI FROM PCCLIBRAMD.PCCFFMOVTF WHERE MVDIACLA=:DIA AND MVCTADB=:CUENTADEBITO AND MVTIPCDB=:TIPOCUENTADEBITO ORDER BY MVHOR DESC, MVMIN DESC,MVSEG DESC LIMIT 1)
SQL.PCCFFMOVTFLOGTF.consultarRegistroCre=SELECT PCCLIBRAMD.PCCFFLOGTF.* FROM PCCLIBRAMD.PCCFFLOGTF WHERE substr(LGDATOS, 106, 10) IN (SELECT MVIDENTI FROM PCCLIBRAMD.PCCFFMOVTF WHERE MVDIACLA=:DIA AND MVCTACR=:CUENTACREDITO AND MVTIPCCR=:TIPOCUENTACREDITO ORDER BY MVHOR DESC, MVMIN DESC,MVSEG DESC LIMIT 1)
SQL.SCIFFSALDO.consultarSaldo=SELECT SDCUENTA, SDTIPOCTA, SDSDODSP, SDFLTDSP, SDDSPINI1, SDTIPOSOB, SDPLAN, SDSDOINIC, SDRETINIC, SDRETACT, SDVLREMB, SDFLTINIC, SDSDOMIN, SDTPEFLT, SDNOTACR, SDNOTADB, SDTPESOB FROM SCILIBRAMD.SCIFFSALDO WHERE SDCUENTA=:CUENTA AND SDTIPOCTA=:TIPOCUENTA
SQL.PCCFFLGAEN.consultaClaveDinamica=SELECT SUBSTR(AENMSGENV,42,6) AS AENMSGENV FROM PCCLIBRAMD.PCCFFLGAEN WHERE AENNROIDE = :DOCUMENTO AND AENFECHA = :FECHA AND AENTPOMSG = '0220' AND AENCODOPE = '315' AND AENCANOPE = :CANAL AND AENHORA >= :HORA ORDER BY AENHORA DESC FETCH FIRST 1 ROW ONLY
SQL.CNAME_WWWFFUSRSV.consultaCliente=SELECT CNNOSS,CNCDTI,ESTADO,IDUSUARIO FROM VISIONR.CNAME INNER JOIN WWWLIBRAMD.WWWFFUSRSV ON CNNOSS=NROIDEN AND CNCDTI=TIPOIDE WHERE CNNOSS=:DOCUMENTO AND ESTADO='A'
SQL.CXREF.consultarListaCreditos=SELECT MBAL.LMNOAC AS NUMERO_CREDITO, MBAL.LMAMPO AS VALOR_TOTAL, MBAL.LMAMAV AS DEUDA_FECHA FROM VISIONR.CXREF XREF INNER JOIN VISIONR.CNAME NAME ON XREF.CXNAMK = NAME.CNNAMK INNER JOIN VISIONR.LMBAL MBAL ON XREF.CXNOAC = MBAL.LMNOAC WHERE NAME.CNNOSS =:DOCUMENTO AND XREF.CXCDAP = 'L'
SQL.ENCARC.consultaFondosInversion=SELECT ENCCOD, ENCCO1, ENCNUM, ENCSAL, ENCIDE FROM libreria.ENCARC WHERE ENCIDE =:DOCUMENTO AND ENCSAL>0
SQL.PCCLIBRAMD.consultarLogTFSaldosTDC=SELECT * FROM PCCLIBRAMD.PCCFFLOGTF GTF WHERE GTF.LGANO =:ANIO AND GTF.LGMES=:MES AND GTF.LGDIA =:DIA AND GTF.LGSIS =:SISTEMA AND GTF.LGTRN = 41 AND GTF.LGDATOS LIKE :DOCUMENTO ORDER BY GTF.LGHH DESC, GTF.LGMM DESC,GTF.LGSS DESC LIMIT :SIZE
SQL.SCIFFSALDO.consultaSaldoPertenenciaCuentaDeposito=SELECT SALDO.SDCUENTA , SALDO.SDTIPOCTA, SALDO.SDSDODSP FROM visionr.cxref XREF inner join visionr.cname NAME on XREF.cxnamk = NAME.cnnamk inner join SCILIBRAMD.SCIFFSALDO SALDO on XREF.CXNOAC = SALDO.SDCUENTA WHERE NAME.CNNOSS=:DOCUMENTO AND XREF.CXCDAP IN('S','D')
SQL.CXREF.saldosPertenenciaTDC=SELECT XREF.CXNOAC AS NUMERO_TARJETA, NAME.CNNOSS AS DOCUMENTO,(CASE WHEN XREF.CXCDAP = 'K' THEN 'Personal American Express ****' || SUBSTRING(XREF.CXNOAC,12,4) ELSE (CASE WHEN XREF.CXCDAP = 'V' THEN 'Personal Visa ****' || SUBSTRING(XREF.CXNOAC,13,4) ELSE (CASE WHEN XREF.CXCDAP = 'M' THEN 'Personal Mastercard ****' || SUBSTRING(XREF.CXNOAC,13,4) END) END)END)FRANQUICIA FROM VISIONR.CXREF XREF INNER JOIN VISIONR.CNAME  NAME ON XREF.CXNAMK = NAME.CNNAMK WHERE NAME.CNNOSS = :NUMERO_DOCUMENTO_CLIENTE AND XREF.CXCDAP IN('K','M','V')
SQL.SCIFFMRCMV.consultaListaMovimientos=WITH TBL_MOVI AS ((SELECT FECHA_EFECTIVA, NUMERO_DE_CUENTA,CODIGO_APLICACION MONTO_DE_LA_TRANSACCION FROM VISIONR.DHIS WHERE NUMERO_DE_CUENTA =:numeroCuenta AND CODIGO_APLICACION =:tipoCuentaLetra ORDER BY DHDATE DESC,DHSSEQ DESC) UNION ALL(SELECT DECIMAL(MOVFECEFC)FECHA, MOVCODCTA CUENTA, MOVVLRTOT VLRTOTAL FROM SCILIBRAMD.SCIFFMRCMV WHERE MOVCODCTA =:numeroCuenta AND MOVTIPCTA =:tipoCuentaNumero ORDER BY MOVFECEFC DESC, MOVHRARCB DESC))SELECT * FROM TBL_MOVI WHERE (DECIMAL(SUBSTR(FECHA_EFECTIVA, 1, 6)))>(SUBSTR(DECIMAL((SELECT CURRENT DATE - 6 MONTHS FROM SYSIBM.SYSDUMMY1)), 1, 6)) ORDER BY FECHA_EFECTIVA DESC FETCH FIRST 20 ROWS ONLY
SQL.CABFFTARJ.consultaTarjetaEprepago=SELECT PNROPSEU, PESTADO, ANOVTO, MESVTO, NROTADIC FROM CABLIBRAMD.CABFFTARJ AS A, CABLIBRAMD.CABFFCTAS AS B, TCBLIBRAMD.TCBFFMAE AS C, CABLIBRAMD.CABFFPPMAE AS D WHERE TJNRODOC=:DOCUMENTO AND TJCLSDOC=:TIPODOCUMENTO AND TJNROBCO=107 AND SUBSTRING(A.TJNROTRJ ,2) = SUBSTRING(B.CANROTRJ,2) AND SUBSTRING(A.TJNROTRJ,2) = C.CUENTA AND CONCAT(C.PREFIJO,C.OFICINA)CONCAT(C.CUENTA) = D.PNROBASE LIMIT 1
